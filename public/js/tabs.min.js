"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.addEventListener("load",function(){var e,t;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),e="undefined"!=typeof global?global:"undefined"!=typeof window?window:this,t=function(u){var l={idPrefix:"tabby-toggle_",default:'[data-tabby-default="true"]'},o=function(e,t){var r;"function"==typeof u.CustomEvent?r=new CustomEvent("tabby",{bubbles:!0,cancelable:!0,detail:t}):(r=document.createEvent("CustomEvent")).initCustomEvent("tabby",!0,!0,t),e.dispatchEvent(r)},n=function(e){e=e.closest('[role="tablist"]');if(!e)return{};e=e.querySelector('[role="tab"][aria-selected="true"]');if(!e)return{};var t=document.querySelector(e.hash);return e.setAttribute("aria-selected","false"),e.setAttribute("tabindex","-1"),t?(t.setAttribute("hidden","hidden"),{previousTab:e,previousContent:t}):{previousTab:e}},i=function(e,t){e.setAttribute("aria-selected","true"),e.setAttribute("tabindex","0"),t.removeAttribute("hidden"),e.focus()},c=function(e){var t,r;!e||"true"==e.getAttribute("aria-selected")||(t=document.querySelector(e.hash))&&(r=n(e),i(e,t),r.tab=e,r.content=t,o(e,r))},d=function(e){var t=e.closest('[role="tablist"]'),t=t?t.querySelectorAll('[role="tab"]'):null;if(t)return{tabs:t,index:Array.prototype.indexOf.call(t,e)}};return function(n,e){var o,t,r={},i=(r.destroy=function(){var e=t.querySelectorAll("a");Array.prototype.forEach.call(e,function(e){var t,r=document.querySelector(e.hash);r&&(r=r,t=o,(e=e).id.slice(0,t.idPrefix.length)===t.idPrefix&&(e.id=""),e.removeAttribute("role"),e.removeAttribute("aria-controls"),e.removeAttribute("aria-selected"),e.removeAttribute("tabindex"),e.closest("li").removeAttribute("role"),r.removeAttribute("role"),r.removeAttribute("aria-labelledby"),r.removeAttribute("hidden"))}),t.removeAttribute("role"),document.documentElement.removeEventListener("click",i,!0),t.removeEventListener("keydown",a,!0),t=o=null},r.setup=function(){var e;(t=document.querySelector(n))&&(e=t.querySelectorAll("a"),t.setAttribute("role","tablist"),Array.prototype.forEach.call(e,function(e){var t,r=document.querySelector(e.hash);r&&(r=r,t=o,(e=e).id||(e.id=t.idPrefix+r.id),e.setAttribute("role","tab"),e.setAttribute("aria-controls",r.id),e.closest("li").setAttribute("role","presentation"),r.setAttribute("role","tabpanel"),r.setAttribute("aria-labelledby",e.id),e.matches(t.default)?e.setAttribute("aria-selected","true"):(e.setAttribute("aria-selected","false"),e.setAttribute("tabindex","-1"),r.setAttribute("hidden","hidden")))}))},r.toggle=function(e){var t=e;"string"==typeof e&&(t=document.querySelector(n+' [role="tab"][href*="'+e+'"]')),c(t)},function(e){var t=e.target.closest(n+' [role="tab"]');t&&(e.preventDefault(),c(t))}),a=function(e){var t,r,o=document.activeElement;!o.matches(n+' [role="tab"]')||["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Up","Down","Left","Right","Home","End"].indexOf(e.key)<0||(o=o,e=e.key,(o=d(o))&&(t=o.tabs.length-1,-1<["ArrowUp","ArrowLeft","Up","Left"].indexOf(e)?r=o.index<1?t:o.index-1:-1<["ArrowDown","ArrowRight","Down","Right"].indexOf(e)?r=o.index===t?0:o.index+1:"Home"===e?r=0:"End"===e&&(r=t),c(o.tabs[r])))};return o=function(){var r={};return Array.prototype.forEach.call(arguments,function(e){for(var t in e){if(!e.hasOwnProperty(t))return;r[t]=e[t]}}),r}(l,e||{}),r.setup(),e=n,u.location.hash.length<1||(e=document.querySelector(e+' [role="tab"][href*="'+u.location.hash+'"]'),c(e)),console.log(t),document.documentElement.addEventListener("click",i,!0),t.addEventListener("keydown",a,!0),r}},"function"==typeof define&&define.amd?define([],function(){return t(e)}):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t(e):e.Tabby=t(e),console.log(document),new Tabby('[data-tabs="true"]')});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhYnMuanMiXSwibmFtZXMiOlsid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIkVsZW1lbnQiLCJwcm90b3R5cGUiLCJtYXRjaGVzIiwibXNNYXRjaGVzU2VsZWN0b3IiLCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3IiLCJtb2R1bGUiLCJnbG9iYWwiLCJ0aGlzIiwiZGVmYXVsdHMiLCJpZFByZWZpeCIsImRlZmF1bHQiLCJlbWl0RXZlbnQiLCJ0YWIiLCJldmVudCIsIkN1c3RvbUV2ZW50IiwiYnViYmxlcyIsImNhbmNlbGFibGUiLCJkZXRhaWwiLCJkb2N1bWVudCIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGV0YWlscyIsImRpc3BhdGNoRXZlbnQiLCJoaWRlIiwidGFiR3JvdXAiLCJuZXdUYWIiLCJxdWVyeVNlbGVjdG9yIiwic2V0QXR0cmlidXRlIiwiY29udGVudCIsImhhc2giLCJwcmV2aW91c1RhYiIsInByZXZpb3VzQ29udGVudCIsInNob3ciLCJyZW1vdmVBdHRyaWJ1dGUiLCJmb2N1cyIsInRvZ2dsZSIsImdldEF0dHJpYnV0ZSIsImdldFRhYnNNYXAiLCJjbG9zZXN0IiwidGFicyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbmRleCIsInN3aXRjaFRhYnMiLCJpbmRleE9mIiwia2V5Iiwic2VsZWN0b3IiLCJvcHRpb25zIiwic2V0dGluZ3MiLCJ0YWJXcmFwcGVyIiwicHVibGljQVBJcyIsImRvY3VtZW50RWxlbWVudCIsImNsaWNrSGFuZGxlciIsImRlc3Ryb3kiLCJBcnJheSIsImNhbGwiLCJkZXN0cm95VGFiIiwiaWQiLCJzbGljZSIsImxlbmd0aCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXlIYW5kbGVyIiwic2V0dXAiLCJmb3JFYWNoIiwidGFyZ2V0IiwicHJldmVudERlZmF1bHQiLCJhY3RpdmVFbGVtZW50IiwibWFwIiwibG9hZEZyb21VUkwiLCJDb25zdHJ1Y3RvciIsIm1lcmdlZCIsImFyZ3VtZW50cyIsIm9iaiIsImhhc093blByb3BlcnR5IiwiZXh0ZW5kIiwibG9jYXRpb24iLCJjb25zb2xlIiwibG9nIiwiZGVmaW5lIiwiZmFjdG9yeSIsInJvb3QiLCJleHBvcnRzIiwiX3R5cGVvZiIsIlRhYmJ5Il0sIm1hcHBpbmdzIjoiOFBBU0FBLE9BQUFDLGlCQUFBLE9BQUEsV0FRQyxJQUhLQyxFQUFRQyxFQUpkRCxRQUFBQyxVQUFBQyxVQUNBRixRQUFBQyxVQUFBQyxRQUFBRixRQUFBQyxVQUFBRSxtQkFBQUgsUUFBQUMsVUFBQUcsdUJBR01KLEVBU0gsb0JBQUFLLE9BQUFDLE9BQUEsb0JBQUFSLE9BQUFBLE9BQUFTLEtBVFdOLEVBU1gsU0FBQUgsR0FZRCxJQUFJVSxFQUFXLENBQ2RDLFNBREdELGdCQUVIRSxRQURBRCwrQkErQkRFLEVBQWEsU0FBR0MsRUFBWkQsR0FHSCxJQUFJRSxFQUNBLG1CQUFBZixFQUFPQSxZQUNWZSxFQUFBQSxJQUFRQyxZQUFJQSxRQUFZLENBQ3ZCQyxTQUFBQSxFQUNBQyxZQUFBQSxFQUNBQyxPQUFBQSxLQUdESixFQUFBQSxTQUFRSyxZQUFTQyxnQkFDakJOLGdCQUFNTyxTQUFnQixHQUFTLEVBQU1DLEdBSXRDVCxFQUFBQSxjQUFJVSxJQW9FSkMsRUFBS0MsU0FBVUMsR0FHZkQsRUFBV0MsRUFBR1AsUUFBU1Esb0JBSHZCLElBQUtGLEVBQVUsTUFBTyxHQU10QlosRUFBSWUsRUFBSkQsY0FBaUIsc0NBSmpCLElBS0FkLEVBQUllLE1BQUFBLEdBSkosSUFBSUMsRUFBVVYsU0FBU1EsY0FBY2QsRUFBSWlCLE1BT3pDLE9BSkFqQixFQUljZSxhQUFBLGdCQUFBLFNBSGRmLEVBSUFnQixhQUFRRCxXQUFhLE1BSXBCRyxHQUpERixFQUtDRyxhQUFlLFNBQUVILFVBS25CLENBQ0ZFLFlBQUFsQixFQUNBbUIsZ0JBQUFILElBVFUsQ0FBQUUsWUFBQWxCLElBWVJvQixFQUFBLFNBQUFwQixFQUFBZ0IsR0FDQ2hCLEVBTURlLGFBQUEsZ0JBQUEsUUFDRmYsRUFBQWUsYUFBQSxXQUFBLEtB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SUFBSzVCLEdBR2I5QixTQUFTZ0MsZ0JBQWdCbkQsaUJBQWlCLFFBQVNvRCxHQUFjLEdBQ2pFSCxFQUFXakQsaUJBQWlCLFVBQVc2RCxHQUFZLEdBVTdDWCxJQTlaVS9DLG1CQUFWRCxRQUEyQjRFLE9BQUM1RSxJQUNwQzRFLE9BQUEsR0FBQSxXQUlFLE9BQU9DLEVBQVFDLEtBRk0sWUFBbEIsb0JBQUFDLFFBQUEsWUFBQUMsUUFBQUQsVUFLSjNFLE9BSkF3RSxRQUFZQyxFQUFBQyxHQU1aQSxFQU5BRyxNQUFBSixFQUFBQyxHQXVhRkosUUFBUUMsSUFBSzFELFVBQ0YsSUFBSWdFLE1BQU0iLCJmaWxlIjoidGFicy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIHRhYmJ5anMgdjEyLjAuM1xuICogTGlnaHR3ZWlnaHQsIGFjY2Vzc2libGUgdmFuaWxsYSBKUyB0b2dnbGUgdGFicy5cbiAqIChjKSAyMDE5IENocmlzIEZlcmRpbmFuZGlcbiAqIE1JVCBMaWNlbnNlXG4gKiBodHRwOi8vZ2l0aHViLmNvbS9jZmVyZGluYW5kaS90YWJieVxuICovXG5cbi8qKlxuICogRWxlbWVudC5tYXRjaGVzKCkgcG9seWZpbGwgKHNpbXBsZSB2ZXJzaW9uKVxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQvbWF0Y2hlcyNQb2x5ZmlsbFxuICovXG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpIHtcblx0aWYgKCFFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzKSB7XG5cdFx0RWxlbWVudC5wcm90b3R5cGUubWF0Y2hlcyA9IEVsZW1lbnQucHJvdG90eXBlLm1zTWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLndlYmtpdE1hdGNoZXNTZWxlY3Rvcjtcblx0fVxuXHQoZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcblx0XHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHtcblx0XHRcdGRlZmluZShbXSwgKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmV0dXJuIGZhY3Rvcnkocm9vdCk7XG5cdFx0XHR9KSk7XG5cdFx0fSBlbHNlIGlmICggdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICkge1xuXHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJvb3QpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyb290LlRhYmJ5ID0gZmFjdG9yeShyb290KTtcblx0XHR9XG5cdH0pKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0aGlzLCAoZnVuY3Rpb24gKHdpbmRvdykge1xuXG5cdFx0J3VzZSBzdHJpY3QnO1xuXG5cdFx0Ly9cblx0XHQvLyBWYXJpYWJsZXNcblx0XHQvL1xuXG5cdFx0dmFyIGRlZmF1bHRzID0ge1xuXHRcdFx0aWRQcmVmaXg6ICd0YWJieS10b2dnbGVfJyxcblx0XHRcdGRlZmF1bHQ6ICdbZGF0YS10YWJieS1kZWZhdWx0PVwidHJ1ZVwiXSdcblx0XHR9O1xuXG5cblx0XHQvL1xuXHRcdC8vIE1ldGhvZHNcblx0XHQvL1xuXG5cdFx0LyoqXG5cdFx0ICogTWVyZ2UgdHdvIG9yIG1vcmUgb2JqZWN0cyB0b2dldGhlci5cblx0XHQgKiBAcGFyYW0gICB7T2JqZWN0fSAgIG9iamVjdHMgIFRoZSBvYmplY3RzIHRvIG1lcmdlIHRvZ2V0aGVyXG5cdFx0ICogQHJldHVybnMge09iamVjdH0gICAgICAgICAgICBNZXJnZWQgdmFsdWVzIG9mIGRlZmF1bHRzIGFuZCBvcHRpb25zXG5cdFx0ICovXG5cdFx0dmFyIGV4dGVuZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHZhciBtZXJnZWQgPSB7fTtcblx0XHRcdEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYXJndW1lbnRzLCAoZnVuY3Rpb24gKG9iaikge1xuXHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdFx0XHRcdFx0aWYgKCFvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgcmV0dXJuO1xuXHRcdFx0XHRcdG1lcmdlZFtrZXldID0gb2JqW2tleV07XG5cdFx0XHRcdH1cblx0XHRcdH0pKTtcblx0XHRcdHJldHVybiBtZXJnZWQ7XG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEVtaXQgYSBjdXN0b20gZXZlbnRcblx0XHQgKiBAcGFyYW0gIHtTdHJpbmd9IHR5cGUgICAgVGhlIGV2ZW50IHR5cGVcblx0XHQgKiBAcGFyYW0gIHtOb2RlfSAgIHRhYiAgICAgVGhlIHRhYiB0byBhdHRhY2ggdGhlIGV2ZW50IHRvXG5cdFx0ICogQHBhcmFtICB7Tm9kZX0gICBkZXRhaWxzIERldGFpbHMgYWJvdXQgdGhlIGV2ZW50XG5cdFx0ICovXG5cdFx0dmFyIGVtaXRFdmVudCA9IGZ1bmN0aW9uICh0YWIsIGRldGFpbHMpIHtcblxuXHRcdFx0Ly8gQ3JlYXRlIGEgbmV3IGV2ZW50XG5cdFx0XHR2YXIgZXZlbnQ7XG5cdFx0XHRpZiAodHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRldmVudCA9IG5ldyBDdXN0b21FdmVudCgndGFiYnknLCB7XG5cdFx0XHRcdFx0YnViYmxlczogdHJ1ZSxcblx0XHRcdFx0XHRjYW5jZWxhYmxlOiB0cnVlLFxuXHRcdFx0XHRcdGRldGFpbDogZGV0YWlsc1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG5cdFx0XHRcdGV2ZW50LmluaXRDdXN0b21FdmVudCgndGFiYnknLCB0cnVlLCB0cnVlLCBkZXRhaWxzKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRGlzcGF0Y2ggdGhlIGV2ZW50XG5cdFx0XHR0YWIuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogUmVtb3ZlIHJvbGVzIGFuZCBhdHRyaWJ1dGVzIGZyb20gYSB0YWIgYW5kIGl0cyBjb250ZW50XG5cdFx0ICogQHBhcmFtICB7Tm9kZX0gICB0YWIgICAgICBUaGUgdGFiXG5cdFx0ICogQHBhcmFtICB7Tm9kZX0gICBjb250ZW50ICBUaGUgdGFiIGNvbnRlbnRcblx0XHQgKiBAcGFyYW0gIHtPYmplY3R9IHNldHRpbmdzIFVzZXIgc2V0dGluZ3MgYW5kIG9wdGlvbnNcblx0XHQgKi9cblx0XHR2YXIgZGVzdHJveVRhYiA9IGZ1bmN0aW9uICh0YWIsIGNvbnRlbnQsIHNldHRpbmdzKSB7XG5cblx0XHRcdC8vIFJlbW92ZSB0aGUgZ2VuZXJhdGVkIElEXG5cdFx0XHRpZiAodGFiLmlkLnNsaWNlKDAsIHNldHRpbmdzLmlkUHJlZml4Lmxlbmd0aCkgPT09IHNldHRpbmdzLmlkUHJlZml4KSB7XG5cdFx0XHRcdHRhYi5pZCA9ICcnO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZW1vdmUgcm9sZXNcblx0XHRcdHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ3JvbGUnKTtcblx0XHRcdHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnKTtcblx0XHRcdHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKTtcblx0XHRcdHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ3RhYmluZGV4Jyk7XG5cdFx0XHR0YWIuY2xvc2VzdCgnbGknKS5yZW1vdmVBdHRyaWJ1dGUoJ3JvbGUnKTtcblx0XHRcdGNvbnRlbnQucmVtb3ZlQXR0cmlidXRlKCdyb2xlJyk7XG5cdFx0XHRjb250ZW50LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5Jyk7XG5cdFx0XHRjb250ZW50LnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQWRkIHRoZSByZXF1aXJlZCByb2xlcyBhbmQgYXR0cmlidXRlcyB0byBhIHRhYiBhbmQgaXRzIGNvbnRlbnRcblx0XHQgKiBAcGFyYW0gIHtOb2RlfSAgIHRhYiAgICAgIFRoZSB0YWJcblx0XHQgKiBAcGFyYW0gIHtOb2RlfSAgIGNvbnRlbnQgIFRoZSB0YWIgY29udGVudFxuXHRcdCAqIEBwYXJhbSAge09iamVjdH0gc2V0dGluZ3MgVXNlciBzZXR0aW5ncyBhbmQgb3B0aW9uc1xuXHRcdCAqL1xuXHRcdHZhciBzZXR1cFRhYiA9IGZ1bmN0aW9uICh0YWIsIGNvbnRlbnQsIHNldHRpbmdzKSB7XG5cblx0XHRcdC8vIEdpdmUgdGFiIGFuIElEIGlmIGl0IGRvZXNuJ3QgYWxyZWFkeSBoYXZlIG9uZVxuXHRcdFx0aWYgKCF0YWIuaWQpIHtcblx0XHRcdFx0dGFiLmlkID0gc2V0dGluZ3MuaWRQcmVmaXggKyBjb250ZW50LmlkO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgcm9sZXNcblx0XHRcdHRhYi5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAndGFiJyk7XG5cdFx0XHR0YWIuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgY29udGVudC5pZCk7XG5cdFx0XHR0YWIuY2xvc2VzdCgnbGknKS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAncHJlc2VudGF0aW9uJyk7XG5cdFx0XHRjb250ZW50LnNldEF0dHJpYnV0ZSgncm9sZScsICd0YWJwYW5lbCcpO1xuXHRcdFx0Y29udGVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsIHRhYi5pZCk7XG5cblx0XHRcdC8vIEFkZCBzZWxlY3RlZCBzdGF0ZVxuXHRcdFx0aWYgKHRhYi5tYXRjaGVzKHNldHRpbmdzLmRlZmF1bHQpKSB7XG5cdFx0XHRcdHRhYi5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFiLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuXHRcdFx0XHR0YWIuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuXHRcdFx0XHRjb250ZW50LnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJ2hpZGRlbicpO1xuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEhpZGUgYSB0YWIgYW5kIGl0cyBjb250ZW50XG5cdFx0ICogQHBhcmFtICB7Tm9kZX0gbmV3VGFiIFRoZSBuZXcgdGFiIHRoYXQncyByZXBsYWNpbmcgaXRcblx0XHQgKi9cblx0XHR2YXIgaGlkZSA9IGZ1bmN0aW9uIChuZXdUYWIpIHtcblxuXHRcdFx0Ly8gVmFyaWFibGVzXG5cdFx0XHR2YXIgdGFiR3JvdXAgPSBuZXdUYWIuY2xvc2VzdCgnW3JvbGU9XCJ0YWJsaXN0XCJdJyk7XG5cdFx0XHRpZiAoIXRhYkdyb3VwKSByZXR1cm4ge307XG5cdFx0XHR2YXIgdGFiID0gdGFiR3JvdXAucXVlcnlTZWxlY3RvcignW3JvbGU9XCJ0YWJcIl1bYXJpYS1zZWxlY3RlZD1cInRydWVcIl0nKTtcblx0XHRcdGlmICghdGFiKSByZXR1cm4ge307XG5cdFx0XHR2YXIgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFiLmhhc2gpO1xuXG5cdFx0XHQvLyBIaWRlIHRoZSB0YWJcblx0XHRcdHRhYi5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcblx0XHRcdHRhYi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG5cblx0XHRcdC8vIEhpZGUgdGhlIGNvbnRlbnRcblx0XHRcdGlmICghY29udGVudCkgcmV0dXJuIHtwcmV2aW91c1RhYjogdGFifTtcblx0XHRcdGNvbnRlbnQuc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAnaGlkZGVuJyk7XG5cblx0XHRcdC8vIFJldHVybiB0aGUgaGlkZGVuIHRhYiBhbmQgY29udGVudFxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0cHJldmlvdXNUYWI6IHRhYixcblx0XHRcdFx0cHJldmlvdXNDb250ZW50OiBjb250ZW50XG5cdFx0XHR9O1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFNob3cgYSB0YWIgYW5kIGl0cyBjb250ZW50XG5cdFx0ICogQHBhcmFtICB7Tm9kZX0gdGFiICAgICAgVGhlIHRhYlxuXHRcdCAqIEBwYXJhbSAge05vZGV9IGNvbnRlbnQgIFRoZSB0YWIgY29udGVudFxuXHRcdCAqL1xuXHRcdHZhciBzaG93ID0gZnVuY3Rpb24gKHRhYiwgY29udGVudCkge1xuXHRcdFx0dGFiLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICd0cnVlJyk7XG5cdFx0XHR0YWIuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XG5cdFx0XHRjb250ZW50LnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XG5cdFx0XHR0YWIuZm9jdXMoKTtcblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogVG9nZ2xlIGEgbmV3IHRhYlxuXHRcdCAqIEBwYXJhbSAge05vZGV9IHRhYiBUaGUgdGFiIHRvIHNob3dcblx0XHQgKi9cblx0XHR2YXIgdG9nZ2xlID0gZnVuY3Rpb24gKHRhYikge1xuXG5cdFx0XHQvLyBNYWtlIHN1cmUgdGhlcmUncyBhIHRhYiB0byB0b2dnbGUgYW5kIGl0J3Mgbm90IGFscmVhZHkgYWN0aXZlXG5cdFx0XHRpZiAoIXRhYiB8fCB0YWIuZ2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJykgPT0gJ3RydWUnKSByZXR1cm47XG5cblx0XHRcdC8vIFZhcmlhYmxlc1xuXHRcdFx0dmFyIGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhYi5oYXNoKTtcblx0XHRcdGlmICghY29udGVudCkgcmV0dXJuO1xuXG5cdFx0XHQvLyBIaWRlIGFjdGl2ZSB0YWIgYW5kIGNvbnRlbnRcblx0XHRcdHZhciBkZXRhaWxzID0gaGlkZSh0YWIpO1xuXG5cdFx0XHQvLyBTaG93IG5ldyB0YWIgYW5kIGNvbnRlbnRcblx0XHRcdHNob3codGFiLCBjb250ZW50KTtcblxuXHRcdFx0Ly8gQWRkIGV2ZW50IGRldGFpbHNcblx0XHRcdGRldGFpbHMudGFiID0gdGFiO1xuXHRcdFx0ZGV0YWlscy5jb250ZW50ID0gY29udGVudDtcblxuXHRcdFx0Ly8gRW1pdCBhIGN1c3RvbSBldmVudFxuXHRcdFx0ZW1pdEV2ZW50KHRhYiwgZGV0YWlscyk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogR2V0IGFsbCBvZiB0aGUgdGFicyBpbiBhIHRhYmxpc3Rcblx0XHQgKiBAcGFyYW0gIHtOb2RlfSAgIHRhYiAgQSB0YWIgZnJvbSB0aGUgbGlzdFxuXHRcdCAqIEByZXR1cm4ge09iamVjdH0gICAgICBUaGUgdGFicyBhbmQgdGhlIGluZGV4IG9mIHRoZSBjdXJyZW50bHkgYWN0aXZlIG9uZVxuXHRcdCAqL1xuXHRcdHZhciBnZXRUYWJzTWFwID0gZnVuY3Rpb24gKHRhYikge1xuXHRcdFx0dmFyIHRhYkdyb3VwID0gdGFiLmNsb3Nlc3QoJ1tyb2xlPVwidGFibGlzdFwiXScpO1xuXHRcdFx0dmFyIHRhYnMgPSB0YWJHcm91cCA/IHRhYkdyb3VwLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyb2xlPVwidGFiXCJdJykgOiBudWxsO1xuXHRcdFx0aWYgKCF0YWJzKSByZXR1cm47XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR0YWJzOiB0YWJzLFxuXHRcdFx0XHRpbmRleDogQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbCh0YWJzLCB0YWIpXG5cdFx0XHR9O1xuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBTd2l0Y2ggdGhlIGFjdGl2ZSB0YWIgYmFzZWQgb24ga2V5Ym9hcmQgYWN0aXZpdHlcblx0XHQgKiBAcGFyYW0gIHtOb2RlfSB0YWIgVGhlIGN1cnJlbnRseSBhY3RpdmUgdGFiXG5cdFx0ICogQHBhcmFtICB7S2V5fSAga2V5IFRoZSBrZXkgdGhhdCB3YXMgcHJlc3NlZFxuXHRcdCAqL1xuXHRcdHZhciBzd2l0Y2hUYWJzID0gZnVuY3Rpb24gKHRhYiwga2V5KSB7XG5cblx0XHRcdC8vIEdldCBhIG1hcCBvZiB0YWJzXG5cdFx0XHR2YXIgbWFwID0gZ2V0VGFic01hcCh0YWIpO1xuXHRcdFx0aWYgKCFtYXApIHJldHVybjtcblx0XHRcdHZhciBsZW5ndGggPSBtYXAudGFicy5sZW5ndGggLSAxO1xuXHRcdFx0dmFyIGluZGV4O1xuXG5cdFx0XHQvLyBHbyB0byBwcmV2aW91cyB0YWJcblx0XHRcdGlmIChbJ0Fycm93VXAnLCAnQXJyb3dMZWZ0JywgJ1VwJywgJ0xlZnQnXS5pbmRleE9mKGtleSkgPiAtMSkge1xuXHRcdFx0XHRpbmRleCA9IG1hcC5pbmRleCA8IDEgPyBsZW5ndGggOiBtYXAuaW5kZXggLSAxO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHbyB0byBuZXh0IHRhYlxuXHRcdFx0ZWxzZSBpZiAoWydBcnJvd0Rvd24nLCAnQXJyb3dSaWdodCcsICdEb3duJywgJ1JpZ2h0J10uaW5kZXhPZihrZXkpID4gLTEpIHtcblx0XHRcdFx0aW5kZXggPSBtYXAuaW5kZXggPT09IGxlbmd0aCA/IDAgOiBtYXAuaW5kZXggKyAxO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBHbyB0byBob21lXG5cdFx0XHRlbHNlIGlmIChrZXkgPT09ICdIb21lJykge1xuXHRcdFx0XHRpbmRleCA9IDA7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gR28gdG8gZW5kXG5cdFx0XHRlbHNlIGlmIChrZXkgPT09ICdFbmQnKSB7XG5cdFx0XHRcdGluZGV4ID0gbGVuZ3RoO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBUb2dnbGUgdGhlIHRhYlxuXHRcdFx0dG9nZ2xlKG1hcC50YWJzW2luZGV4XSk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQWN0aXZhdGUgYSB0YWIgYmFzZWQgb24gdGhlIFVSTFxuXHRcdCAqIEBwYXJhbSAge1N0cmluZ30gc2VsZWN0b3IgVGhlIHNlbGVjdG9yIGZvciB0aGlzIGluc3RhbnRpYXRpb25cblx0XHQgKi9cblx0XHR2YXIgbG9hZEZyb21VUkwgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcblx0XHRcdGlmICh3aW5kb3cubG9jYXRpb24uaGFzaC5sZW5ndGggPCAxKSByZXR1cm47XG5cdFx0XHR2YXIgdGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvciArICcgW3JvbGU9XCJ0YWJcIl1baHJlZio9XCInICsgd2luZG93LmxvY2F0aW9uLmhhc2ggKyAnXCJdJyk7XG5cdFx0XHR0b2dnbGUodGFiKTtcblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQ3JlYXRlIHRoZSBDb25zdHJ1Y3RvciBvYmplY3Rcblx0XHQgKi9cblx0XHR2YXIgQ29uc3RydWN0b3IgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIG9wdGlvbnMpIHtcblxuXHRcdFx0Ly9cblx0XHRcdC8vIFZhcmlhYmxlc1xuXHRcdFx0Ly9cblxuXHRcdFx0dmFyIHB1YmxpY0FQSXMgPSB7fTtcblx0XHRcdHZhciBzZXR0aW5ncywgdGFiV3JhcHBlcjtcblxuXG5cdFx0XHQvL1xuXHRcdFx0Ly8gTWV0aG9kc1xuXHRcdFx0Ly9cblxuXHRcdFx0cHVibGljQVBJcy5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRcdC8vIEdldCBhbGwgdGFic1xuXHRcdFx0XHR2YXIgdGFicyA9IHRhYldyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnYScpO1xuXG5cdFx0XHRcdC8vIEFkZCByb2xlcyB0byB0YWJzXG5cdFx0XHRcdEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwodGFicywgKGZ1bmN0aW9uICh0YWIpIHtcblxuXHRcdFx0XHRcdC8vIEdldCB0aGUgdGFiIGNvbnRlbnRcblx0XHRcdFx0XHR2YXIgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFiLmhhc2gpO1xuXHRcdFx0XHRcdGlmICghY29udGVudCkgcmV0dXJuO1xuXG5cdFx0XHRcdFx0Ly8gU2V0dXAgdGhlIHRhYlxuXHRcdFx0XHRcdGRlc3Ryb3lUYWIodGFiLCBjb250ZW50LCBzZXR0aW5ncyk7XG5cblx0XHRcdFx0fSkpO1xuXG5cdFx0XHRcdC8vIFJlbW92ZSByb2xlIGZyb20gd3JhcHBlclxuXHRcdFx0XHR0YWJXcmFwcGVyLnJlbW92ZUF0dHJpYnV0ZSgncm9sZScpO1xuXG5cdFx0XHRcdC8vIFJlbW92ZSBldmVudCBsaXN0ZW5lcnNcblx0XHRcdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xpY2tIYW5kbGVyLCB0cnVlKTtcblx0XHRcdFx0dGFiV3JhcHBlci5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5SGFuZGxlciwgdHJ1ZSk7XG5cblx0XHRcdFx0Ly8gUmVzZXQgdmFyaWFibGVzXG5cdFx0XHRcdHNldHRpbmdzID0gbnVsbDtcblx0XHRcdFx0dGFiV3JhcHBlciA9IG51bGw7XG5cblx0XHRcdH07XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogU2V0dXAgdGhlIERPTSB3aXRoIHRoZSBwcm9wZXIgYXR0cmlidXRlc1xuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWNBUElzLnNldHVwID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRcdC8vIFZhcmlhYmxlc1xuXHRcdFx0XHR0YWJXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG5cdFx0XHRcdGlmICghdGFiV3JhcHBlcikgcmV0dXJuO1xuXHRcdFx0XHR2YXIgdGFicyA9IHRhYldyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnYScpO1xuXG5cdFx0XHRcdC8vIEFkZCByb2xlIHRvIHdyYXBwZXJcblx0XHRcdFx0dGFiV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAndGFibGlzdCcpO1xuXG5cdFx0XHRcdC8vIEFkZCByb2xlcyB0byB0YWJzXG5cdFx0XHRcdEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwodGFicywgKGZ1bmN0aW9uICh0YWIpIHtcblxuXHRcdFx0XHRcdC8vIEdldCB0aGUgdGFiIGNvbnRlbnRcblx0XHRcdFx0XHR2YXIgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFiLmhhc2gpO1xuXHRcdFx0XHRcdGlmICghY29udGVudCkgcmV0dXJuO1xuXG5cdFx0XHRcdFx0Ly8gU2V0dXAgdGhlIHRhYlxuXHRcdFx0XHRcdHNldHVwVGFiKHRhYiwgY29udGVudCwgc2V0dGluZ3MpO1xuXG5cdFx0XHRcdH0pKTtcblxuXHRcdFx0fTtcblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBUb2dnbGUgYSB0YWIgYmFzZWQgb24gYW4gSURcblx0XHRcdCAqIEBwYXJhbSAge1N0cmluZ3xOb2RlfSBpZCBUaGUgdGFiIHRvIHRvZ2dsZVxuXHRcdFx0ICovXG5cdFx0XHRwdWJsaWNBUElzLnRvZ2dsZSA9IGZ1bmN0aW9uIChpZCkge1xuXG5cdFx0XHRcdC8vIEdldCB0aGUgdGFiXG5cdFx0XHRcdHZhciB0YWIgPSBpZDtcblx0XHRcdFx0aWYgKHR5cGVvZiBpZCA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHR0YWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yICsgJyBbcm9sZT1cInRhYlwiXVtocmVmKj1cIicgKyBpZCArICdcIl0nKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFRvZ2dsZSB0aGUgdGFiXG5cdFx0XHRcdHRvZ2dsZSh0YWIpO1xuXG5cdFx0XHR9O1xuXG5cdFx0XHQvKipcblx0XHRcdCAqIEhhbmRsZSBjbGljayBldmVudHNcblx0XHRcdCAqL1xuXHRcdFx0dmFyIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uIChldmVudCkge1xuXG5cdFx0XHRcdC8vIE9ubHkgcnVuIG9uIHRvZ2dsZXNcblx0XHRcdFx0dmFyIHRhYiA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KHNlbGVjdG9yICsgJyBbcm9sZT1cInRhYlwiXScpO1xuXHRcdFx0XHRpZiAoIXRhYikgcmV0dXJuO1xuXG5cdFx0XHRcdC8vIFByZXZlbnQgbGluayBiZWhhdmlvclxuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdC8vIFRvZ2dsZSB0aGUgdGFiXG5cdFx0XHRcdHRvZ2dsZSh0YWIpO1xuXG5cdFx0XHR9O1xuXG5cdFx0XHQvKipcblx0XHRcdCAqIEhhbmRsZSBrZXlkb3duIGV2ZW50c1xuXHRcdFx0ICovXG5cdFx0XHR2YXIga2V5SGFuZGxlciA9IGZ1bmN0aW9uIChldmVudCkge1xuXG5cdFx0XHRcdC8vIE9ubHkgcnVuIGlmIGEgdGFiIGlzIGluIGZvY3VzXG5cdFx0XHRcdHZhciB0YWIgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXHRcdFx0XHRpZiAoIXRhYi5tYXRjaGVzKHNlbGVjdG9yICsgJyBbcm9sZT1cInRhYlwiXScpKSByZXR1cm47XG5cblx0XHRcdFx0Ly8gT25seSBydW4gZm9yIHNwZWNpZmljIGtleXNcblx0XHRcdFx0aWYgKFsnQXJyb3dVcCcsICdBcnJvd0Rvd24nLCAnQXJyb3dMZWZ0JywgJ0Fycm93UmlnaHQnLCAnVXAnLCAnRG93bicsICdMZWZ0JywgJ1JpZ2h0JywgJ0hvbWUnLCAnRW5kJ10uaW5kZXhPZihldmVudC5rZXkpIDwgMCkgcmV0dXJuO1xuXG5cdFx0XHRcdC8vIFN3aXRjaCB0YWJzXG5cdFx0XHRcdHN3aXRjaFRhYnModGFiLCBldmVudC5rZXkpO1xuXG5cdFx0XHR9O1xuXG5cdFx0XHQvKipcblx0XHRcdCAqIEluaXRpYWxpemUgdGhlIGluc3RhbmNlXG5cdFx0XHQgKi9cblx0XHRcdHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRcdC8vIE1lcmdlIHVzZXIgb3B0aW9ucyB3aXRoIGRlZmF1bHRzXG5cdFx0XHRcdHNldHRpbmdzID0gZXh0ZW5kKGRlZmF1bHRzLCBvcHRpb25zIHx8IHt9KTtcblxuXHRcdFx0XHQvLyBTZXR1cCB0aGUgRE9NXG5cdFx0XHRcdHB1YmxpY0FQSXMuc2V0dXAoKTtcblxuXHRcdFx0XHQvLyBMb2FkIGEgdGFiIGZyb20gdGhlIFVSTFxuXHRcdFx0XHRsb2FkRnJvbVVSTChzZWxlY3Rvcik7XG5cblx0XHRcdFx0Y29uc29sZS5sb2coIHRhYldyYXBwZXIgKTtcblxuXHRcdFx0XHQvLyBBZGQgZXZlbnQgbGlzdGVuZXJzXG5cdFx0XHRcdGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrSGFuZGxlciwgdHJ1ZSk7XG5cdFx0XHRcdHRhYldyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleUhhbmRsZXIsIHRydWUpO1xuXG5cdFx0XHR9O1xuXG5cblx0XHRcdC8vXG5cdFx0XHQvLyBJbml0aWFsaXplIGFuZCByZXR1cm4gdGhlIFB1YmxpYyBBUElzXG5cdFx0XHQvL1xuXG5cdFx0XHRpbml0KCk7XG5cdFx0XHRyZXR1cm4gcHVibGljQVBJcztcblxuXHRcdH07XG5cblxuXHRcdC8vXG5cdFx0Ly8gUmV0dXJuIHRoZSBDb25zdHJ1Y3RvclxuXHRcdC8vXG5cblx0XHRyZXR1cm4gQ29uc3RydWN0b3I7XG5cblx0fSkpO1xuXG5cdGNvbnNvbGUubG9nKCBkb2N1bWVudCApO1xuXHR2YXIgdGFicyA9IG5ldyBUYWJieSgnW2RhdGEtdGFicz1cInRydWVcIl0nKTtcbiB9KTtcbiJdfQ==